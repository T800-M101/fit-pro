<section class="auth-section">
  <div class="container">
    <div class="auth-card">
      <h2 class="title">
        {{ isRecoveringPassword ? "Create New Password" : "Forgot Password?" }}
      </h2>
      <p class="subtitle">
        {{ isRecoveringPassword ? "Choose a strong password to secure your account" : "We'll help you get back in" }}
      </p>

      <form (ngSubmit)="onSubmit()" [formGroup]="form">
        @if(!isRecoveringPassword){
        <div class="form-group">
          <label for="email">Email</label>
          <input formControlName="email" type="email" id="email" placeholder="Enter your email" />
          @if(form.get('email')?.invalid && form.get('email')?.touched){
          @if(form.get('email')?.errors?.['required']){
          <small class="error">Email is required.</small>
          }
          @if(form.get('email')?.errors?.['email']){
          <small class="error">Enter a valid email.</small>
          }
          }
        </div>
        } @else {
        <div class="form-group">
          <label for="password">New Password</label>
          <input formControlName="password" type="password" id="password" placeholder="Enter new password" />
          @if(form.get('password')?.invalid && form.get('password')?.touched){
          @if(form.get('password')?.errors?.['required']){
          <small class="error">Password is required.</small>
          }
          @if(form.get('password')?.errors?.['minlength']){
          <small class="error">
            Password must be at least 8 characters.
          </small>
          }
          }
        </div>

        <div class="form-group">
          <label for="confirmPassword">Repeat Password</label>
          <input formControlName="confirmPassword" type="password" id="confirmPassword"
            placeholder="Repeat new password" />
          @if( form.get('confirmPassword')?.invalid && form.get('confirmPassword')?.touched){
          @if(form.get('confirmPassword')?.errors?.['required']){
          <small class="error">Please repeat the password.</small>
          }
          @if(form.get('confirmPassword')?.errors?.['passwordMismatch']){
          <small class="error">Passwords do not match.</small>
          }
          }
        </div>
        }
        <button [disabled]="form.invalid" class="btn-recover" type="submit">
          {{this.isRecoveringPassword ? 'Change Password' : 'Send Recovery Link'}}
        </button>

        @if(isRecoveringPassword ){
        <div class="signup-link">
          <p>Remember your password? <a routerLink="/sign-in">Login</a></p>
        </div>
        }
      </form>

    </div>
  </div>
</section>

<app-spinner [isLoading]="isLoading"></app-spinner>